generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum UserRole {
  MEMBER
  ADMIN
}

enum UserPlan {
  FREE
  PRO
  PREMIUM
}

model User {
  id String @id @default(uuid()) @map("_id")

  name     String
  email    String  @unique
  password String?
  image    String?

  role              UserRole @default(MEMBER)
  plan              UserPlan @default(FREE)
  monthlyTokenUsage Int      @default(0)
  tokenResetDate    DateTime @default(now())

  lastLogin DateTime

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  chat Chat[]

  @@index([role, monthlyTokenUsage, tokenResetDate])
}

// TODO: in future add image field so that if the chat has an image generate it will store it's url and we'll use imagekit to save the image or any other provider.

model Chat {
  id String @id @default(uuid()) @map("_id")

  chat      String[]
  tokenUsed Int      @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user   User?   @relation(fields: [userId], references: [id])
  userId String?
}
